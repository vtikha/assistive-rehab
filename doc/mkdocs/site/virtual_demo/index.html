



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A framework for developing the assistive intelligence of R1 for clinical rehabilitation.">
      
      
        <link rel="canonical" href="https://github.com/robotology/assistive-rehab/virtual_demo/">
      
      
        <meta name="author" content="Valentina vasco">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>How to run the virtual demo - assistive-rehab</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.0284f74d.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.01803549.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="" data-md-color-accent="amber">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#how-to-run-the-virtual-demo" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://github.com/robotology/assistive-rehab" title="assistive-rehab" class="md-header-nav__button md-logo">
          
            <i class="md-icon">dashboard</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              assistive-rehab
            </span>
            <span class="md-header-nav__topic">
              
                How to run the virtual demo
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/robotology/assistive-rehab/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    robotology/assistive-rehab
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href=".." title="Home" class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../latest_news/" title="News" class="md-tabs__link">
          News
        </a>
      
    </li>
  

      
        
      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../tutorial_intro/" title="Tutorials" class="md-tabs__link md-tabs__link--active">
          Tutorials
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../Y1M5/" title="Milestones" class="md-tabs__link">
          Milestones
        </a>
      
    </li>
  

      
        
      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://github.com/robotology/assistive-rehab" title="assistive-rehab" class="md-nav__button md-logo">
      
        <i class="md-icon">dashboard</i>
      
    </a>
    assistive-rehab
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/robotology/assistive-rehab/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    robotology/assistive-rehab
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      News
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        News
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../latest_news/" title="Latest" class="md-nav__link">
      Latest
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../install/" title="Install" class="md-nav__link">
      Install
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://robotology.github.io/assistive-rehab/doc/doxygen/doc/html/index.html" title="Documentation [v0.4.0]" class="md-nav__link">
      Documentation [v0.4.0]
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tutorial_intro/" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../create_new_skeleton/" title="How to manage a skeleton object" class="md-nav__link">
      How to manage a skeleton object
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../replay_an_experiment/" title="How to replay an experiment" class="md-nav__link">
      How to replay an experiment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../disembodied/" title="How to run the pipeline in a disembodied manner" class="md-nav__link">
      How to run the pipeline in a disembodied manner
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../align_signals/" title="How to temporally align two signals" class="md-nav__link">
      How to temporally align two signals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../main_apps/" title="How to run the main applications" class="md-nav__link">
      How to run the main applications
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        How to run the virtual demo
      </label>
    
    <a href="./" title="How to run the virtual demo" class="md-nav__link md-nav__link--active">
      How to run the virtual demo
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dependencies" title="Dependencies" class="md-nav__link">
    Dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requirements" title="Requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-virtual-demo" title="Run the virtual demo" class="md-nav__link">
    Run the virtual demo
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Milestones
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Milestones
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Y1M5/" title="Y1M5" class="md-nav__link">
      Y1M5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Y1Q3/" title="Y1Q3" class="md-nav__link">
      Y1Q3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../comparison_releases/" title="Comparison between Y1Q3 and Y1M5" class="md-nav__link">
      Comparison between Y1Q3 and Y1M5
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../about/" title="About" class="md-nav__link">
      About
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dependencies" title="Dependencies" class="md-nav__link">
    Dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requirements" title="Requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-virtual-demo" title="Run the virtual demo" class="md-nav__link">
    Run the virtual demo
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/robotology/assistive-rehab/edit/master/doc/mkdocs/data/virtual_demo.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="how-to-run-the-virtual-demo">How to run the virtual demo<a class="headerlink" href="#how-to-run-the-virtual-demo" title="Permanent link">&para;</a></h1>
<p>This tutorial will show you how to run the <em>virtual</em> demo.
The virtual demo replicates the <a href="https://robotology.github.io/assistive-rehab/doc/mkdocs/site/main_apps/">demo</a> with the real R1 in a virtual environment (<code>Gazebo</code>), with the virtual version of the robot:</p>
<p><img alt="virtual-r1" src="https://user-images.githubusercontent.com/9716288/58802764-4104ab80-860e-11e9-868f-fce8e7708d49.png" /></p>
<p>The virtual R1 is shown on a screen with a RealSense on the top (indicated by the red arrow in the picture).
In this demo, the user in the field of view is automatically engaged and the interaction includes three phases:</p>
<ol>
<li><strong>observation phase</strong>: the virtual robot welcomes the user and <em>shows</em> the exercise to perform;</li>
<li><strong>direct imitation phase</strong>: the virtual robot performs the exercise together with the user, while <em>providing a verbal feedback</em> on how the exercise is being performed;</li>
<li><strong>occluded imitation phase</strong>: the virtual robot keeps performing the exercise <em>behind a panel</em> and <em>stops providing the verbal feedback</em>.</li>
</ol>
<p>Features like facial expressions, gazing the user and a verbal feedback are also included, such that the interaction is as close as possible to the real one.</p>
<p>The related application can be found <a href="https://github.com/robotology/assistive-rehab/tree/master/app/scripts">here</a>, named <em>AssistiveRehab-TWM-virtual.xml.template</em>.</p>
<h2 id="dependencies">Dependencies<a class="headerlink" href="#dependencies" title="Permanent link">&para;</a></h2>
<p>After <a href="https://robotology.github.io/assistive-rehab/doc/mkdocs/site/install/">installing</a> <code>assistive-rehab</code>, you will need the following dependencies:</p>
<ul>
<li><a href="https://github.com/IntelRealSense/librealsense">RealSense</a>: for running the RealSense;</li>
<li><a href="https://github.com/robotology/cer">cer</a>: for running the gaze-controller and face expressions;</li>
<li><a href="http://gazebosim.org/tutorials?cat=install">gazebo</a>: for running the virtual environment;</li>
<li><a href="https://github.com/robotology/gazebo-yarp-plugins">gazebo-yarp-plugins</a>: for exposing YARP interfaces in <code>Gazebo</code>;</li>
<li><a href="https://github.com/robotology/cer-sim">cer-sim</a>: which includes the model loaded by <code>Gazebo</code> in <em>AssistiveRehab-TWM-virtual.xml.template</em>;</li>
<li><a href="https://github.com/robotology/speech">speech</a>: for running the <code>iSpeak</code> module.</li>
</ul>
<h2 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h2>
<p>The following hardware is required:</p>
<ul>
<li><strong>RealSense camera</strong>;</li>
<li><strong>NVIDIA graphics card</strong>: for running <code>yarpOpenPose</code> and <code>actionRecognizer</code>.</li>
</ul>
<h2 id="run-the-virtual-demo">Run the virtual demo<a class="headerlink" href="#run-the-virtual-demo" title="Permanent link">&para;</a></h2>
<p>To run the demo, first run <code>yarpserver</code>.
Connect the RealSense to your laptop.
Open <code>yarpmanager</code>, run the <code>AssistiveRehab-TWM-virtual App</code> and connect.
A virtual R1 appears within the simulation environment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, <code>Gazebo</code> has the origin and the external gui visible. To remove the origin, you can click on <code>View</code> and deselect <code>Origin</code>. To remove the gui, you can click on <code>Window</code> and <code>Full screen</code>.</p>
</div>
<p>When the demo is launched, the <code>interactionManager</code> waits for the command <code>start_observation</code> to start the exercise session. Specifically, the following commands should be sent <em>in this order</em> to the rpc port <code>/interactionManager/cmd:rpc</code>:</p>
<ul>
<li><code>start_observation</code>: to start the observation phase, where the robot looks for a user and, when it founds her/him, starts showing the exercise to be performed;</li>
<li><code>start_imitation</code>: to start the direct imitation phase, where the robot performs the exercise together with the user, while providing her/him with verbal feedback;</li>
<li><code>start_occlusion</code>: to start the occluded imitation phase, where the robot keeps performing the exercise behind a panel and stops providing the verbal feedback;</li>
<li><code>stop</code>: to stop the interaction.</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>A different kind of interaction is also allowed, requiring the user to raise her/his hand to start the interaction. Such interaction includes the observation and the direct imitation phases, with the virtual robot <em>showing</em> the exercise to perform and, right after, <em>performing</em> the exercise while <em>providing a verbal feedback</em> (this is the virtual version of the demo <a href="../Y1M5/">Y1M5</a>). In this configuration, the command <code>start_with_hand</code> starts the interaction and, when the user raises her/his hand, the two phases are run in a row, one after the other, without waiting any additional command.</p>
</div>
<p>The following picture shows an <em>example</em> of interaction during the <em>direct</em> and <em>occluded</em> imitation phase:</p>
<p><img alt="virtual-r1" src="https://user-images.githubusercontent.com/9716288/58812028-45868f80-8621-11e9-8c06-95df4f0a4d7e.gif" /></p>
<p>During the <em>direct</em> imitation phase, the robot moves while providing verbal feedback (the mouth appears on the robot's screen). During the <em>occluded</em> imitation phase, a panel appears occluding the moving arm and the robot stops providing verbal feedback (the mouth only appears at the end of the exercise, when the robot warns the user that the exercise is over).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The shown interaction is just an example and the number of repetitions of the exercise is higher by default.</p>
</div>
<p>The parameters used for this application can be found in the context <a href="https://github.com/robotology/assistive-rehab/tree/master/app/conf/train-with-me"><code>train-with-me</code></a>. Specifically, parameters that control the repetitions of the arm movements are defined in the  <code>interactionManager.ini</code> as <code>nrep-show</code> and <code>nrep-perform</code>, respectively for the observation phase (set to <code>8</code> by default) and the imitation phase, both direct and occluded (set to <code>16</code> by default). The command <code>start_occlusion</code> can be sent after the eighth  repetition of the movement within the direct phase, to have <code>8</code> repetitions for each phase.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../main_apps/" title="How to run the main applications" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                How to run the main applications
              </span>
            </div>
          </a>
        
        
          <a href="../Y1M5/" title="Y1M5" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Y1M5
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2019 Istituto Italiano di Tecnologia - iCub Facility
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>